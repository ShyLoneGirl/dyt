<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<style type="text/css">
		body, html,#allmap {width: 100%;height: 100%;overflow: hidden;margin:0;font-family:"???o?;}
	</style>
	<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=jkbYMs6byLBRXsot1XoGVxf5"></script>
	<script src="audio.min.js"></script>
	<title>嵩山路校区智能</title>
</head>
<body>


<audio id="mus"  style ="width:auto;height:40px"><source src="musi.mp3" type="audio/mpeg"></audio>

	<div id="allmap">
		</div>
</body>
</html>



<script type="text/javascript" src="http://api.map.baidu.com/api?v=1.2"></script>
<script type="text/javascript" src="http://api.map.baidu.com/library/GeoUtils/1.2/src/GeoUtils_min.js"></script>





<script>
	




//三个地图控制按钮
function sxs()
{
	if(map.getZoom()>10&&map.getZoom()<20)
		map.setZoom(map.getZoom()-1);
	else 
		map.setZoom(10);
}
function fds()
{
	if(map.getZoom()>9&&map.getZoom()<19)
		map.setZoom(map.getZoom()+1);
	else 
		map.setZoom(19);
}
function gws()
{
			map.panTo(sp);

}


//播放暂停方法
function bf(){
	if(document.getElementById("bfzt").innerHTML=="播放"&&document.getElementById("mus").paused==true&&document.getElementById("mus").readyState!=0){
		document.getElementById("mus").play(); 
		document.getElementById("bfzt").innerHTML="暂停";
	}
	else {
		document.getElementById("mus").pause(); 
		document.getElementById("bfzt").innerHTML="播放";
	}
}
	
//音频线程
function adp(){
	if(document.getElementById("mus").ended==true)
		document.getElementById("bfzt").innerHTML="播放";
	if(document.getElementById("mus").readyState!=0)
		document.getElementById("hc").innerHTML="音频就绪";
	else 
		document.getElementById("hc").innerHTML="音频准备中...";
	

}
//功能
//画矩形	
function drawrec(pStart,pEnd){	
	var rectangle = new BMap.Polygon([
		new BMap.Point(pStart.lng,pStart.lat),
		new BMap.Point(pEnd.lng,pStart.lat),
		new BMap.Point(pEnd.lng,pEnd.lat),
		new BMap.Point(pStart.lng,pEnd.lat)
	], {strokeColor:"blue", strokeWeight:2, strokeOpacity:0.5,fillColor:"",enableMassClear:false});
	map.addOverlay(rectangle);         //增加矩形
}

//在区域否
function panbie(pStart,pEnd,pset)
{
	var c = new BMap.Bounds(pStart,pEnd); //测试Bounds对象
  var result = BMapLib.GeoUtils.isPointInRect(pset, c);
	return result;
}


//各种自定义控件添加	
function zdykj(){
var blc = new BMap.ScaleControl({anchor: BMAP_ANCHOR_BOTTOM_LEFT});// 坐下，添加比例尺
map.addControl(blc); //比例尺 


var sxx = new BMap.CopyrightControl({anchor: BMAP_ANCHOR_BOTTOM_RIGHT,offset:new BMap.Size(10,85)});  
sxx.addCopyright({id: 1, content: "<button id = 'sxsx' onclick='sxs()' style='width:50px;height:50px;'>缩小</button>"}); 
map.addControl(sxx); //缩小  

var fdd = new BMap.CopyrightControl({anchor: BMAP_ANCHOR_BOTTOM_RIGHT,offset:new BMap.Size(10,25)});  
fdd.addCopyright({id: 2, content: "<button id = 'fdfd' onclick='fds()' style='width:50px;height:50px;'>放大</button>"}); 
map.addControl(fdd); //放大 

 
var gw = new BMap.CopyrightControl({anchor: BMAP_ANCHOR_BOTTOM_LEFT,offset:new BMap.Size(10,30)});  
gw.addCopyright({id: 3, content: "<button id = 'wzz' onclick='gws()' style='width:48px;height:48px;background-color: transparent;border:0;background-image:url(tb.jpg)'></button>"}); 



map.addControl(gw); //我的位置  

//var ad = new BMap.CopyrightControl({anchor: BMAP_ANCHOR_TOP_LEFT});  
//ad.addCopyright({id: 4, content: "		<audio id='mus'  style ='width:auto;height:40px'><source src='welcometohaut.mp3' type='audio/mpeg'></audio>"}); 
//map.addControl(ad); //播放器  



var bff = new BMap.CopyrightControl({anchor:  BMAP_ANCHOR_BOTTOM_RIGHT,offset:new BMap.Size(10,145)});  
bff.addCopyright({id: 5, content: "<button id = 'bfzt' onclick='bf()' style='width:50px;height:50px;'>播放</button>"}); 
map.addControl(bff); //播放



var bff = new BMap.CopyrightControl({anchor:  BMAP_ANCHOR_TOP_LEFT});  
bff.addCopyright({id: 6, content: "<button id = 'hc' disabled = 'true'   style='width:auto;height:30px;background:yellow'>音频准备中...</button>"}); 
map.addControl(bff); //准备显示 	


//添加下拉菜单控件 显示方法在外面
//var sel = new BMap.CopyrightControl({anchor: BMAP_ANCHOR_TOP_RIGHT});  
//map.addControl(sel); //选择菜单控件  


}



//坐标
	var shauts = new BMap.Point(113.630389,34.744611);
	var shaute = new BMap.Point(113.634539,34.748896);
//??	


	
	var sxinans = new BMap.Point(113.630389,34.744611);
	var sxinane = new BMap.Point(113.632864,34.745734);
	
//?ф	
	var szxs = new BMap.Point(113.632145,34.74576);
	var szxe = new BMap.Point(113.633668,34.747113);
	
	
	
	
//?±±	
//	var sxibeis = new BMap.Point(113.630389,34.747554);
//	var sxibeie = new BMap.Point(113.631408,34.748896);
	
	
//??1?
	
	
	
	var stygs = new BMap.Point(113.630389,34.745734);
	var styge = new BMap.Point(113.632145,34.747554);
	
	
	
//a	
	
	var sz2s = new BMap.Point(113.630389,34.744611);
	var sz2e = new BMap.Point(113.632864,34.745734);
	
	
//
	
	var saas = new BMap.Point(113.631408,34.748429);
	var saae = new BMap.Point(113.632913,34.748896);				
	//
	
	var scts = new BMap.Point(113.631408,34.747554);
	var scte = new BMap.Point(113.632913,34.748429);		


//
	var slibs = new BMap.Point(113.632927,34.744881);
	var slibe = new BMap.Point(113.634279,34.745741);		



var sp = 1;
var map = new BMap.Map("allmap");
var point = new BMap.Point(113.632962,34.746468);
map.centerAndZoom(point,17);
zdykj();	

var adplay=setInterval(function(){adp()},500);


var sel = new BMap.CopyrightControl({anchor: BMAP_ANCHOR_TOP_RIGHT});  
xlcd();
 
function xlcd(){
	return sel.addCopyright({id: 7, content: "<select id = 'sele' name='music' onchange='qiehuan(this)' style = 'width:120px;height:40px'><option value='hgd#'>欢迎光临河工大</option><option value='hegongda#'>河南工业大学简介</option></select>"}); 
	}




function qiehuan(selObj)
{
//	alert(selObj.options[selObj.selectedIndex].value);
if(selObj.options[selObj.selectedIndex].value=="ct#"){
 	document.getElementById("mus").src= "welcometocanting.mp3"; 
 	document.getElementById("bfzt").innerHTML="播放";}
 	
if(selObj.options[selObj.selectedIndex].value=="ct1#"){
	document.getElementById("mus").src= "1can.mp3"; 
	document.getElementById("bfzt").innerHTML="播放";}
	
if(selObj.options[selObj.selectedIndex].value=="ct2#"){
	document.getElementById("mus").src= "2can.mp3"; 
	document.getElementById("bfzt").innerHTML="播放";}
	
if(selObj.options[selObj.selectedIndex].value=="ct3#"){
	document.getElementById("mus").src= "3can.mp3"; 
	document.getElementById("bfzt").innerHTML="播放";}
			
			
			
if(selObj.options[selObj.selectedIndex].value=="tyg#"){
	document.getElementById("mus").src= "welcometotiyuguan.mp3";
	document.getElementById("bfzt").innerHTML="播放";}
	 
if(selObj.options[selObj.selectedIndex].value=="tyg1#"){
	document.getElementById("mus").src= "tiyuguan.mp3";
	document.getElementById("bfzt").innerHTML="播放";}
	 
if(selObj.options[selObj.selectedIndex].value=="tyg2#"){
	
	document.getElementById("mus").src= "tiyuchang.mp3"; 
	document.getElementById("bfzt").innerHTML="播放";}
	
if(selObj.options[selObj.selectedIndex].value=="tyg3#"){
	document.getElementById("mus").src= "xiyubu.mp3";
	document.getElementById("bfzt").innerHTML="播放";}
	 
if(selObj.options[selObj.selectedIndex].value=="tyg4#"){
	document.getElementById("mus").src= "kaishuifang.mp3"; 
	document.getElementById("bfzt").innerHTML="播放";}
	


	
	
if(selObj.options[selObj.selectedIndex].value=="jxl#"){
	document.getElementById("mus").src= "welcometojiaoxuelou.mp3"; 
	document.getElementById("bfzt").innerHTML="播放";}
	
if(selObj.options[selObj.selectedIndex].value=="jxl1#"){
	document.getElementById("mus").src= "jiaoxuelou.mp3"; 
	document.getElementById("bfzt").innerHTML="播放";}	


if(selObj.options[selObj.selectedIndex].value=="jxl2#"){
	document.getElementById("mus").src= "zhongxinshiyanlou.mp3"; 
	document.getElementById("bfzt").innerHTML="播放";}
	
	if(selObj.options[selObj.selectedIndex].value=="jxl3#"){
	document.getElementById("mus").src= "shiyanlou.mp3";
	document.getElementById("bfzt").innerHTML="播放";}
	
	
	

	
	
	if(selObj.options[selObj.selectedIndex].value=="xinan#"){
 	document.getElementById("mus").src= "xinanqu.mp3"; 
 	document.getElementById("bfzt").innerHTML="播放";
}
 	
if(selObj.options[selObj.selectedIndex].value=="xinan1#"){
	document.getElementById("mus").src= "jixujiaoyuxueyuan.mp3"; 
	document.getElementById("bfzt").innerHTML="播放";}
	
if(selObj.options[selObj.selectedIndex].value=="xinan2#"){
	document.getElementById("mus").src= "xiaoyiyuan.mp3"; 
	document.getElementById("bfzt").innerHTML="播放";}
	
	
	
	
	
	
	
	
	
if(selObj.options[selObj.selectedIndex].value=="lib#"){
	document.getElementById("mus").src= "lib.mp3"; 
	document.getElementById("bfzt").innerHTML="播放";}
			
if(selObj.options[selObj.selectedIndex].value=="lib1#"){
	document.getElementById("mus").src= "tushuguan.mp3";
	document.getElementById("bfzt").innerHTML="播放";
	}
if(selObj.options[selObj.selectedIndex].value=="lib2#"){
	document.getElementById("mus").src= "9haolou.mp3";
	document.getElementById("bfzt").innerHTML="播放";}
	 

	
	
	
	}


drawrec(shauts,shaute);
drawrec(sxinans,sxinane);
drawrec(szxs,szxe);
//drawrec(sxibeis,sxibeie);

drawrec(stygs,styge);
//drawrec(sz2s,sz2e);
//drawrec(saas,saae);

drawrec(scts,scte);

drawrec(slibs,slibe);

var geolocation = new BMap.Geolocation();
geolocation.getCurrentPosition(function(r){
	if(this.getStatus() == BMAP_STATUS_SUCCESS){
		var mk = new BMap.Marker(r.point);
		map.addOverlay(mk);
		map.panTo(r.point);
//	alert('您的位置：'+r.point.lng+','+r.point.lat) 
		sp = r.point;
    var  pb = 1;    
    //at haut
    if(panbie(shauts,shaute,r.point)== true){
    	document.getElementById("mus").src= "welcometohaut.mp3"; 
    	map.addControl(sel); //添加选择菜单控件 
//  	alert('您的位置：'+r.point.lng+','+r.point.lat);
			var myVar=setInterval(function(){myTimer()},2000);
			function myTimer(){
				var ge = new BMap.Geolocation();
				ge.getCurrentPosition(function(r){
					if(this.getStatus() == BMAP_STATUS_SUCCESS){
					var mk = new BMap.Marker(r.point);
					map.clearOverlays();
			    map.addOverlay(mk);
			    		    

			    if(panbie(scts,scte,r.point)== true){
 			//	  alert("餐厅");  				    	
			    	if(pb != 4){
		    			document.getElementById("mus").src= "welcometocanting.mp3"; 
		    			sel.addCopyright({id:7, content: "<select id = 'sele' name='music' onchange='qiehuan(this)' style = 'width:120px;height:40px'><option value='ct#'>餐厅</option><option value='ct1#'>一餐</option><option value='ct2#'>二餐</option><option value='ct3#'>三餐</option></select>"}); 
			    		pb =4;
			  		}
			    }
			     else if(panbie(stygs,styge,r.point)== true){
// 				   alert("体育馆1?);     				       
 				      if(pb != 5){
 				       		document.getElementById("mus").src= "welcometotiyuguan.mp3"; 
		    					sel.addCopyright({id:7, content: "<select id = 'sele' name='music' onchange='qiehuan(this)' style = 'width:120px;height:40px'><option value='tyg#'>体育馆</option><option value='tyg1#'>场地</option><option value='tyg2#'>足球场</option><option value='tyg3#'>洗浴中心</option><option value='tyg4#'>开水房</option></select>"});  				       		
 				       		pb =5;
 				       		}
 				  }

			     else if(panbie(szxs,szxe,r.point)== true){
// 				   alert("教学楼");     				       
 				      if(pb != 7){
 				       		document.getElementById("mus").src= "welcometojiaoxuequ.mp3"; 
		    					sel.addCopyright({id:7, content: "<select id = 'sele' name='music' onchange='qiehuan(this)' style = 'width:120px;height:40px'><option value='jxl#'>教学区</option><option value='jxl1#'>教学楼</option><option value='jxl2#'>中心实验室</option><option value='jxl3#'>实验楼</option></select>"});  				       		
 				       		pb =7;
 				       		}
 				  }

			     else if(panbie(sxinans,sxinane,r.point)== true){
// 				   alert("西南区");     				       
 				      if(pb != 6){
 				       		document.getElementById("mus").src= "xinanqu.mp3"; 
		    					sel.addCopyright({id:7, content: "<select id = 'sele' name='music' onchange='qiehuan(this)' style = 'width:120px;height:40px'><option value='xinan#'>西南区</option><option value='xinan1#'>继续教育学院</option><option value='xinan2#'>医院</option></select>"});  				       		
 				       		pb =6;
 				       		}
 				  }
	       
			     else if(panbie(slibs,slibe,r.point)== true){
// 				   alert("图书馆"?);     				       
 				      if(pb != 8){
 				       		document.getElementById("mus").src= "lib.mp3"; 
		    					sel.addCopyright({id:7, content: "<select id = 'sele' name='music' onchange='qiehuan(this)' style = 'width:120px;height:40px'><option value='lib#'>图书馆</option><option value='lib1#'>简介</option><option value='lib2#'>附近9号楼</option></select>"});  				       		
 				       		pb =8;
 				       		}
 				  } 
 
 
 	        else
 	        	{
 	        		if(pb!=88){
 	        		document.getElementById("mus").src= "welcometohaut.mp3";
 	        		sel.addCopyright({id: 7, content: "<select id = 'sele' name='music' onchange='qiehuan(this)' style = 'width:120px;height:40px'><option value='hgd#'>欢迎光临河工大</option><option value='hegongda#'>河南工业大学简介</option></select>"}); 
 	        	pb=88}
 	        		} 
 				      				       	
} 
 				    	
 					else {
 						alert('failed'+this.getStatus());
 					}        
 				},{enableHighAccuracy: true})
 				       			}
 		}
 	}

 	else {
 		alert("您已不在河南工业大学");
 	}        
},{enableHighAccuracy: true})
					
					
</script>






